<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>여행 계획 달력</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="calendar-container">
    <div class="calendar" id="calendar1">
      <button class="month-nav" onclick="changeBothMonths(-1)">이전</button>
      <div class="calendar-content" id="calendar1-content"></div>
    </div>
    <div class="calendar" id="calendar2">
      <div class="calendar-content" id="calendar2-content"></div>
      <button class="month-nav" onclick="changeBothMonths(1)">다음</button>
    </div>
  </div>

  <script>
    // 월 이름 배열
    const monthNames = [
      '1월', '2월', '3월', '4월', '5월', '6월',
      '7월', '8월', '9월', '10월', '11월', '12월'
    ];

    let currentMonth1 = new Date().getMonth(); // 현재 달력1의 월
    let currentYear1 = new Date().getFullYear(); // 현재 달력1의 년도

    let currentMonth2 = 4; // 달력2는 5월 (0-based index)
    let currentYear2 = 2025; // 달력2는 2025년

    // 달력1, 달력2를 생성
    generateCalendar('calendar1', currentMonth1, currentYear1, 'calendar1-content');
    generateCalendar('calendar2', currentMonth2, currentYear2, 'calendar2-content');

    // 달력 생성 함수
    function generateCalendar(id, month, year, contentId) {
      const container = document.getElementById(contentId);
      
      const firstDay = new Date(year, month, 1);
      const lastDay = new Date(year, month + 1, 0);
    
      const totalDays = lastDay.getDate();
      const firstDayOfWeek = firstDay.getDay();
    
      // 월 이름 표시
      const monthName = document.createElement('div');
      monthName.classList.add('month-name');
      monthName.textContent = `${monthNames[month]} ${year}`;
      container.innerHTML = ''; // 기존 내용 삭제 후 새로 생성
      container.appendChild(monthName);
    
      // 요일 표시
      const weekdays = document.createElement('div');
      weekdays.classList.add('weekdays');
      const weekdaysNames = ['일', '월', '화', '수', '목', '금', '토'];
      weekdaysNames.forEach(day => {
        const weekday = document.createElement('div');
        weekday.textContent = day;
        weekdays.appendChild(weekday);
      });
      container.appendChild(weekdays);
    
      // 날짜 표시
      const days = document.createElement('div');
      days.classList.add('days');
    
      // 빈 날짜 채우기
      for (let i = 0; i < firstDayOfWeek; i++) {
        const emptyDay = document.createElement('div');
        days.appendChild(emptyDay);
      }
    
      // 실제 날짜 채우기
      for (let i = 1; i <= totalDays; i++) {
        const day = document.createElement('div');
        day.classList.add('day');
        day.textContent = i;
        day.dataset.date = `${year}-${month + 1}-${i}`;
        days.appendChild(day);
      }
    
      container.appendChild(days);
    
      // 클릭 이벤트 추가
      const dayElements = container.querySelectorAll('.day');
      dayElements.forEach(day => {
        day.addEventListener('click', () => handleDayClick(day));
      });
    }

    let selectedStartDate = null;
    let selectedEndDate = null;
    
    function handleDayClick(dayElement) {
      const clickedDate = dayElement.dataset.date;
    
      if (!selectedStartDate) {
        selectedStartDate = clickedDate;
        dayElement.classList.add('selected', 'selected-start'); // 시작 날짜 하이라이트
      } else if (!selectedEndDate) {
        selectedEndDate = clickedDate;
    
        // 시작 날짜와 종료 날짜 순서를 보장
        if (new Date(selectedEndDate) < new Date(selectedStartDate)) {
          [selectedStartDate, selectedEndDate] = [selectedEndDate, selectedStartDate];
        }
    
        highlightRange(selectedStartDate, selectedEndDate); // 날짜 범위 하이라이트
      } else {
        // 이미 시작과 종료 날짜가 선택된 경우, 선택 초기화
        selectedStartDate = clickedDate;
        selectedEndDate = null;
        resetSelection();
        dayElement.classList.add('selected', 'selected-start'); // 새로운 시작 날짜 하이라이트
      }
    }
    
    function highlightRange(startDate, endDate) {
      const start = new Date(startDate);
      const end = new Date(endDate);
      const dayElements = document.querySelectorAll('.day');
    
      // 날짜 비교 시, 시간 부분을 무시하고 날짜만 비교하기 위해 YYYY-MM-DD 형식으로 변환
      const startISO = start.toISOString().split('T')[0];
      const endISO = end.toISOString().split('T')[0];
    
      dayElements.forEach(day => {
        const dayDate = new Date(day.dataset.date);
        const dayISO = dayDate.toISOString().split('T')[0];
    
        if (dayISO >= startISO && dayISO <= endISO) {
          if (dayISO === startISO) {
            day.classList.add('selected-start');
          } else if (dayISO === endISO) {
            day.classList.add('selected-end');  // 종료 날짜 하이라이트
          } else {
            day.classList.add('selected-range');
          }
        } else {
          day.classList.remove('selected-range', 'selected-start', 'selected-end');
        }
      });
    }
    
    function resetSelection() {
      const dayElements = document.querySelectorAll('.day');
      dayElements.forEach(day => {
        day.classList.remove('selected', 'selected-range', 'selected-start', 'selected-end');
      });
    }
    
    // 두 달력을 동시에 변경하는 함수
    function changeBothMonths(direction) {
      // 달력 1과 달력 2의 월을 모두 변경
      currentMonth1 += direction;
      currentMonth2 += direction;

      if (currentMonth1 < 0) {
        currentMonth1 = 11;
        currentYear1--;
      } else if (currentMonth1 > 11) {
        currentMonth1 = 0;
        currentYear1++;
      }

      if (currentMonth2 < 0) {
        currentMonth2 = 11;
        currentYear2--;
      } else if (currentMonth2 > 11) {
        currentMonth2 = 0;
        currentYear2++;
      }

      // 두 달력을 업데이트
      generateCalendar('calendar1', currentMonth1, currentYear1, 'calendar1-content');
      generateCalendar('calendar2', currentMonth2, currentYear2, 'calendar2-content');
    }
  </script>
</body>
</html>
